<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Registrierung – Homedex</title>
  <style>
    /* ============= copy-paste gleichen CSS wie login.html ============= */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    :root {
      --col-header: #f2f4f8;
      --col-hero-bg: #e8f0fe;
      --col-primary: #007bff;
      --col-accent: #6c63ff;
      --col-light: #ffffff;
      --col-dark: #333333;
      --radius: 8px;
    }
    body { font-family: 'Segoe UI', sans-serif; color: var(--col-dark); background: var(--col-light); }
    a { text-decoration: none; color: inherit; }
    header { background: var(--col-header); padding: 1rem 2rem; display: flex; align-items: center; gap: 2rem; }
    .logo { font-size: 1.8rem; font-weight: bold; }
    .lang-switch { margin-left: 1rem; }
    nav { margin-left: auto; }
    nav ul { list-style: none; display: flex; gap: 1rem; }
    nav a { font-weight: 500; transition: color .2s; }
    nav a:hover { color: var(--col-primary); }
    .hero.small-hero { background: var(--col-hero-bg); text-align: center; padding: 4rem 2rem 2rem; }
    .hero.small-hero h2 { font-size: 2rem; margin-bottom: .5rem; color: var(--col-dark); }
    .hero.small-hero p { color: #555; }
    .search-section { max-width: 400px; margin: 2rem auto; background: var(--col-light); padding: 2rem; border-radius: var(--radius); box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
    .search-section h2 { margin-bottom: 1rem; font-size: 1.5rem; text-align: center; }
    .search-form { display: flex; flex-wrap: wrap; gap: .75rem; }
    .search-form input, .search-form button { flex: 1 1 100%; padding: .75rem; border: 1px solid #ccc; border-radius: var(--radius); font-size: 1rem; }
    .search-form button { background: var(--col-primary); color: var(--col-light); border: none; cursor: pointer; }
    .search-section .message { margin-top: .75rem; text-align: center; color: red; }
    .search-section p { text-align: center; margin-top: 1rem; font-size: .9rem; }
    .search-section p a { color: var(--col-primary); }
    footer { background: var(--col-header); padding: 1.5rem 2rem; text-align: center; }
    footer a { color: var(--col-primary); font-weight: 600; }
  </style>
</head>
<body>

  <!-- HEADER -->
  <header>
    <div class="logo">Homedex</div>
    <div class="lang-switch">
      <select onchange="changeLanguage(this.value)">
        <option value="de">DE</option>
        <option value="en">EN</option>
        <option value="ar">AR</option>
      </select>
    </div>
    <nav>
      <ul>
        <li><a href="login.html" data-i18n="nav.login">Login</a></li>
        <li><a href="about.html" data-i18n="nav.about">Über uns</a></li>
        <li><a href="datenschutz.html" data-i18n="nav.privacy">Datenschutz</a></li>
        <li><a href="jobs.html" data-i18n="nav.jobs">Jobs</a></li>
        <li><a href="impressum.html" data-i18n="nav.imprint">Impressum</a></li>
      </ul>
    </nav>
  </header>

  <!-- HERO small-hero -->
  <section class="hero small-hero">
    <h2 data-i18n="reg.heroTitle">Registrieren Sie sich</h2>
    <p data-i18n="reg.heroSub">Erstellen Sie ein Konto, um Ihre Traumimmobilie zu finden</p>
  </section>

  <!-- REGISTRIERUNG -->
  <section class="search-section">
    <h2 data-i18n="reg.title">Registrierung</h2>
    <form id="regForm" class="search-form">
      <input type="text" name="firstName" placeholder="" data-i18n-placeholder="reg.firstName" required/>
      <input type="text" name="lastName" placeholder="" data-i18n-placeholder="reg.lastName" required/>
      <input type="date" name="birthDate" placeholder="" data-i18n-placeholder="reg.birthDate" required/>
      <input type="text" name="country" placeholder="" data-i18n-placeholder="reg.country" required/>
      <input type="email" name="email" placeholder="" data-i18n-placeholder="reg.email" required/>
      <input type="password" name="password" placeholder="" data-i18n-placeholder="reg.password" required/>
      <button type="submit" class="btn-primary" data-i18n="reg.submit">Registrieren</button>
    </form>
    <p>
      <span data-i18n="reg.haveAccount">Bereits ein Konto?</span>
      <a href="login.html" data-i18n="reg.loginNow">Jetzt einloggen</a>
    </p>
    <div id="regMessage" class="message"></div>
  </section>

  <!-- FOOTER -->
  <footer>
    <span data-i18n="footer.copy">© 2025 Homedex – Alle Rechte vorbehalten.</span><br/>
    <a href="immobilien-bewerten.html" data-i18n="footer.rate">Immobilie bewerten</a>
  </footer>

  <!-- TRANSLATION & REG-LOGIK -->
  <script>
    const translations = {
      de: {
        logo:"Homedex","nav.login":"Login","nav.about":"Über uns","nav.privacy":"Datenschutz","nav.jobs":"Jobs","nav.imprint":"Impressum",
        "reg.heroTitle":"Registrieren Sie sich","reg.heroSub":"Erstellen Sie ein Konto, um Ihre Traumimmobilie zu finden",
        "reg.title":"Registrierung","reg.firstName":"Vorname","reg.lastName":"Nachname","reg.birthDate":"Geburtsdatum",
        "reg.country":"Land","reg.email":"E-Mail","reg.password":"Passwort","reg.submit":"Registrieren",
        "reg.haveAccount":"Bereits ein Konto?","reg.loginNow":"Jetzt einloggen",
        "footer.copy":"© 2025 Homedex – Alle Rechte vorbehalten.","footer.rate":"Immobilie bewerten"
      },
      en: {
        logo:"Homedex","nav.login":"Login","nav.about":"About us","nav.privacy":"Privacy policy","nav.jobs":"Jobs","nav.imprint":"Imprint",
        "reg.heroTitle":"Register","reg.heroSub":"Create an account to find your dream property",
        "reg.title":"Registration","reg.firstName":"First name","reg.lastName":"Last name","reg.birthDate":"Birth date",
        "reg.country":"Country","reg.email":"Email","reg.password":"Password","reg.submit":"Register",
        "reg.haveAccount":"Already have an account?","reg.loginNow":"Log in now",
        "footer.copy":"© 2025 Homedex – All rights reserved.","footer.rate":"Rate property"
      },
      ar: {
        logo:"هومديكس","nav.login":"تسجيل الدخول","nav.about":"معلومات عنا","nav.privacy":"سياسة الخصوصية","nav.jobs":"وظائف","nav.imprint":"الطابع",
        "reg.heroTitle":"سجل","reg.heroSub":"قم بإنشاء حساب للعثور على عقارك المفضل",
        "reg.title":"التسجيل","reg.firstName":"الاسم الأول","reg.lastName":"اسم العائلة","reg.birthDate":"تاريخ الميلاد",
        "reg.country":"الدولة","reg.email":"البريد الإلكتروني","reg.password":"كلمة المرور","reg.submit":"سجل",
        "reg.haveAccount":"هل لديك حساب؟","reg.loginNow":"تسجيل الدخول الآن",
        "footer.copy":"© 2025 هومديكس – جميع الحقوق محفوظة.","footer.rate":"قيم العقار"
      }
    };

    function translate(lang) {
      document.documentElement.lang = lang;
      document.documentElement.dir = lang==='ar'?'rtl':'ltr';
      document.querySelectorAll('[data-i18n]').forEach(el=>{
        const key=el.getAttribute('data-i18n');
        if(translations[lang][key]) el.textContent=translations[lang][key];
      });
      document.querySelectorAll('[data-i18n-placeholder]').forEach(el=>{
        const key=el.getAttribute('data-i18n-placeholder');
        if(translations[lang][key]) el.placeholder=translations[lang][key];
      });
    }
    function changeLanguage(lang){ translate(lang); }
    window.addEventListener('DOMContentLoaded', ()=>translate('de'));

    document.getElementById('regForm').addEventListener('submit', async e=>{
      e.preventDefault();
      const f=e.target, msg=document.getElementById('regMessage');
      msg.textContent='';
      const data={
        firstName:f.firstName.value.trim(), lastName:f.lastName.value.trim(),
        birthDate:f.birthDate.value, country:f.country.value.trim(),
        email:f.email.value.trim(), password:f.password.value, role:'client'
      };
      if(Object.values(data).some(v=>!v)){ msg.textContent='Bitte alle Felder ausfüllen.'; return; }
      try {
        const existing=await (await fetch(`${location.origin}/users?email=${encodeURIComponent(data.email)}`)).json();
        if(existing.length){ msg.textContent='E-Mail existiert bereits.'; return; }
        await fetch(`${location.origin}/users`, {
          method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify(data)
        });
        window.location.href='login.html';
      } catch {
        msg.textContent='Serverfehler. Bitte später erneut versuchen.';
      }
    });
  </script>
</body>
</html>
