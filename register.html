<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Registrieren – Homedex</title>
  <link rel="stylesheet" href="css/styles.css"/>
</head>
<body>
  <!-- HEADER -->
  <header>
    <div class="logo" data-i18n="logo">Homedex</div>
    <div class="lang-switch">
      <select onchange="changeLanguage(this.value)">
        <option value="de">DE</option>
        <option value="en">EN</option>
        <option value="ar">AR</option>
      </select>
    </div>
    <nav>
      <ul>
        <li><a href="login.html" data-i18n="nav.login">Login</a></li>
        <li><a href="about.html" data-i18n="nav.about">Über uns</a></li>
        <li><a href="datenschutz.html" data-i18n="nav.privacy">Datenschutz</a></li>
        <li><a href="jobs.html" data-i18n="nav.jobs">Jobs</a></li>
        <li><a href="impressum.html" data-i18n="nav.imprint">Impressum</a></li>
      </ul>
    </nav>
  </header>

  <!-- HERO small-hero -->
  <section class="hero small-hero">
    <div class="hero-overlay"></div>
    <div class="hero-content container">
      <h2 data-i18n="reg.heroTitle">Registrieren Sie sich</h2>
      <p data-i18n="reg.heroSub">Erstellen Sie ein Konto, um Ihre Traumimmobilie zu finden</p>
    </div>
  </section>

  <!-- REGISTRIERUNG -->
  <main class="container">
    <div class="auth-card stylish-auth-card">
      <h3 data-i18n="reg.title">Registrierung</h3>
      <form id="regForm" class="auth-form">
        <label class="auth-label">
          <span data-i18n="reg.firstName">Vorname</span>
          <input type="text" name="firstName" placeholder="" data-i18n-placeholder="reg.firstName" required/>
        </label>
        <label class="auth-label">
          <span data-i18n="reg.lastName">Nachname</span>
          <input type="text" name="lastName" placeholder="" data-i18n-placeholder="reg.lastName" required/>
        </label>
        <label class="auth-label">
          <span data-i18n="reg.birthDate">Geburtsdatum</span>
          <input type="date" name="birthDate" placeholder="" data-i18n-placeholder="reg.birthDate" required/>
        </label>
        <label class="auth-label">
          <span data-i18n="reg.country">Land</span>
          <input type="text" name="country" placeholder="" data-i18n-placeholder="reg.country" required/>
        </label>
        <label class="auth-label">
          <span data-i18n="reg.email">E-Mail</span>
          <input type="email" name="email" placeholder="" data-i18n-placeholder="reg.email" required/>
        </label>
        <label class="auth-label">
          <span data-i18n="reg.password">Passwort</span>
          <input type="password" name="password" placeholder="" data-i18n-placeholder="reg.password" required/>
        </label>
        <button type="submit" class="auth-button" data-i18n="reg.submit">Registrieren</button>
      </form>
      <p class="auth-footer-text">
        <span data-i18n="reg.haveAccount">Bereits ein Konto?</span>
        <a href="login.html" data-i18n="reg.loginNow">Jetzt einloggen</a>
      </p>
      <div id="regMessage" class="message"></div>
    </div>
  </main>

  <!-- FOOTER -->
  <footer class="ft-main">
    <div class="ft-container">
      <span data-i18n="footer.copy">© 2025 Homedex – Alle Rechte vorbehalten.</span>
      <a href="immobilien-bewerten.html" class="ft-link" data-i18n="footer.rate">Immobilie bewerten</a>
    </div>
  </footer>

  <!-- TRANSLATION & REG-LOGIK -->
  <script>
    const translations = {
      de: {
        logo:"Homedex",
        "nav.login":"Login","nav.about":"Über uns","nav.privacy":"Datenschutz","nav.jobs":"Jobs","nav.imprint":"Impressum",
        "reg.heroTitle":"Registrieren Sie sich","reg.heroSub":"Erstellen Sie ein Konto, um Ihre Traumimmobilie zu finden",
        "reg.title":"Registrierung","reg.firstName":"Vorname","reg.lastName":"Nachname","reg.birthDate":"Geburtsdatum",
        "reg.country":"Land","reg.email":"E-Mail","reg.password":"Passwort","reg.submit":"Registrieren",
        "reg.haveAccount":"Bereits ein Konto?","reg.loginNow":"Jetzt einloggen",
        "footer.copy":"© 2025 Homedex – Alle Rechte vorbehalten.","footer.rate":"Immobilie bewerten"
      },
      en: {
        logo:"Homedex",
        "nav.login":"Login","nav.about":"About us","nav.privacy":"Privacy policy","nav.jobs":"Jobs","nav.imprint":"Imprint",
        "reg.heroTitle":"Register","reg.heroSub":"Create an account to find your dream property",
        "reg.title":"Registration","reg.firstName":"First name","reg.lastName":"Last name","reg.birthDate":"Birth date",
        "reg.country":"Country","reg.email":"Email","reg.password":"Password","reg.submit":"Register",
        "reg.haveAccount":"Already have an account?","reg.loginNow":"Log in now",
        "footer.copy":"© 2025 Homedex – All rights reserved.","footer.rate":"Rate property"
      },
      ar: {
        logo:"هومديكس",
        "nav.login":"تسجيل الدخول","nav.about":"معلومات عنا","nav.privacy":"سياسة الخصوصية","nav.jobs":"وظائف","nav.imprint":"الطابع",
        "reg.heroTitle":"سجل","reg.heroSub":"قم بإنشاء حساب للعثور على عقارك المفضل",
        "reg.title":"التسجيل","reg.firstName":"الاسم الأول","reg.lastName":"اسم العائلة","reg.birthDate":"تاريخ الميلاد",
        "reg.country":"الدولة","reg.email":"البريد الإلكتروني","reg.password":"كلمة المرور","reg.submit":"سجل",
        "reg.haveAccount":"هل لديك حساب؟","reg.loginNow":"تسجيل الدخول الآن",
        "footer.copy":"© 2025 هومديكس – جميع الحقوق محفوظة.","footer.rate":"قيم العقار"
      }
    };

    function translate(lang) {
      document.documentElement.lang = lang;
      document.documentElement.dir = lang==='ar'?'rtl':'ltr';
      document.querySelectorAll('[data-i18n]').forEach(el=>{
        const key=el.getAttribute('data-i18n');
        if(translations[lang][key]) el.textContent=translations[lang][key];
      });
      document.querySelectorAll('[data-i18n-placeholder]').forEach(el=>{
        const key=el.getAttribute('data-i18n-placeholder');
        if(translations[lang][key]) el.placeholder=translations[lang][key];
      });
    }
    function changeLanguage(lang){ translate(lang); }
    window.addEventListener('DOMContentLoaded', ()=>translate('de'));

    document.getElementById('regForm').addEventListener('submit', async e=>{
      e.preventDefault();
      const form=e.target, msg=document.getElementById('regMessage');
      msg.textContent='';
      const data={
        firstName: form.firstName.value.trim(),
        lastName:  form.lastName.value.trim(),
        birthDate: form.birthDate.value,
        country:   form.country.value.trim(),
        email:     form.email.value.trim(),
        password:  form.password.value,
        role: 'client'
      };
      if(Object.values(data).some(v=>!v)){
        msg.textContent='Bitte alle Felder ausfüllen.';
        return;
      }
      // Registrierungs-API
      try{
        const res=await fetch(`${location.origin}/users?email=${encodeURIComponent(data.email)}`);
        const exists=await res.json();
        if(exists.length){ msg.textContent='E-Mail existiert bereits.'; return; }
        await fetch(`${location.origin}/users`,{
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body:JSON.stringify(data)
        });
        window.location.href='login.html';
      }catch{
        msg.textContent='Serverfehler. Bitte später erneut versuchen.';
      }
    });
  </script>
</body>
</html>

